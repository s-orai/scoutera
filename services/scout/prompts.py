"""
Scout サービスで使用するプロンプト文面。
format_prompt* では変数の埋め込みのみ行い、文面の変更はこのファイルで行う。
"""

# 候補者ピックアップ（必須要件・歓迎要件・求人に基づくスカウト判定）
PROMPT_SCOUT_MATCHING = """
            あなたは優秀なリクルーターです。企業のリクルーターとして、添付した募集求人(ファイル名：{job_title})に対しての候補者にダイレクトスカウトを送信します。
            【PDFの扱いについて】
            ・ファイル名：{job_title}は募集求人として読み取ってください。
            ・ファイル名：{job_title}以外のファイルは候補者情報として読み取ってください。
            ・添付するPDFには複数の候補者の職歴が載っている場合があります。
            ・PDFに記載されている候補者情報を全員分読み取ってください。
            ・判定はファイル名：{job_title}以外のファイルに対して行ってください。

            【IDの取り扱いについて】
            ・ファイル名に数字が含まれているので、その数字を「id」として扱ってください。
            ・ファイル名に数字が含まれておらず、1つのPDFに複数の候補者情報が記載されている場合は、各候補者の最初の情報として「BU」から始まる9文字のIDが記載されています。
              → この9文字のIDを「id」として扱ってください。

            スカウト業務を以下のSTEP1、STEP2の流れで対応してください。

            【STEP 1：候補者ごとの送付可否判定】
            各候補者について以下の形式で判定してください。
            - STEP1における必須要件を満たすか(required_condition): "A" or "B" or "C"
            - STEP1における歓迎要件を満たすか(welcome_condition): "A" or "B" or "C"
            - STEP1の結果(候補者の評価結果)(evaluation_result): "A" or "B" or "C"
            - 必須要件、歓迎要件の結果を踏まえた候補者の評価理由(evaluation_reason): 判定の理由（200文字以内）

            ・複数の候補者情報が記載されたPDFを添付します。それぞれの候補者についてA/B/Cの判定をしてください。
            判定条件は次の通りです。
              ・A評価：必須要件を満たし、かつ歓迎要件を一部以上満たす場合
              ・B評価：必須要件は満たすが、歓迎要件は満たさない場合
              ・C評価：必須要件を一部でも満たさない場合

            <必須要件>
              {required_condition}

            <歓迎要件>
              {welcome_condition}

            【STEP 2：以下の条件、および例を参考に、添付ファイルの候補者全員分、声をかけた背景を伝える文章を作成してください。（STEP1の結果、C評価の候補者についても作成すること）】
            ## 募集求人
            添付ファイル：{job_title}
            ## 文章作成時の条件
            ・180字前後で作成する
            ・1行目は「特に、」で固定する
            ・2~4行目は、候補者の経験の中でも特に活かせるスキル・経験を箇条書きで3つ挙げる
            ・5行目は、2~4行目で上げたスキルが弊社で活かせるということに繋げる文章

            ## 文章の作成例
            特に、
            ・高負荷APIの安定化
            ・障害時の切り分けを可能にするログ設計
            ・Next.js / Node.js を用いた刷新経験
            ・決済系の深い実装経験（楽天Edy・レシート印刷など）
            は、LINE注文・管理画面・決済まわりを含む当社のシステム刷新の中核にそのまま活かせる領域です。

            【出力形式（必ずこの通りの純粋なJSONで出力）】
            {{
              "result": [
                {{
                  "id": "<PDFのファイル名>",
                  "required_condition"：true or false,
                  "welcome_condition"：true or false,
                  "evaluation_reason"："理由",
                  "evaluation_result"：A or B or C,
                  "scout_message"："文面",
                }}
              ]
            }}

            ・すべての候補者をJSON形式での配列にまとめて返してください。
            ・これは最終出力であり、途中思考は出力しないでください。
            """

# スカウト素材出力（ビズリーチ検索軸・スカウト文面）
PROMPT_SCOUT_MATERIAL = """
            あなたは企業の採用担当として、ビズリーチを用いて、募集ポジションにマッチする候補者にダイレクトスカウトを送信します。
            求人票にマッチする候補者を抽出するために、ビズリーチでの検索軸をどう設定するか、考えて出力してください。
            また候補者に送信するスカウト文面を作成し、出力してください。

            # 募集ポジション情報
            {pdf_title}

            # 検索軸の出力条件
            出力する目的は「募集ポジションにマッチする候補者を抽出すること」です。
            以下の項目を、それぞれの条件に基づいて出力してください。
            ## 経験職種
            募集ポジションの業務内容を分析し、候補者が直近で経験しているべき職種を出力してください。
             - ビズリーチの職種大分類・中分類に準拠してください
             - 必須要件を満たす職種だけでなく、スキルの転用が可能な周辺職種も併せて提案してください
            ## 経験業種
            募集ポジションのターゲットが属している可能性が高い業界を出力してください。
             - ビズリーチの業種大分類・中分類に準拠してください
             - 同業種(競合)だけでなく、ビジネスモデルが類似している業界や顧客層が共通している業界も含め、範囲を狭めすぎずに出力してください
            ## 検索キーワード
            募集ポジションの業務内容を分析し、候補者が経験しているべき具体的なスキル・経験を出力してください。
             - 経験職種、経験業種だけでは拾えない具体的なスキル・経験でフィルタリングをする目的です
             - キーワードごとに1つ空白を入れる形で出力してください（キーワード1 キーワード2 キーワード3）
             - 必須スキル/ツール名(Python, SQL, GCPなど)など
             - 具体的な経験/プロジェクト名(新規事業, IPO準備, エンタープライズセールス)など
            ## 現年収
            募集ポジションの想定年収と、求められる役職レイヤーを考慮し、検索対象とする候補者の、現年収の下限および上限を設定してください。
             - 「○○万円〜△△万円」の形式で出力してください
             - 一般的に提示年収の80%~100%程度に位置する層がターゲットになりやすいことを踏まえてください
            ## 希望年収
            募集ポジションで提示可能な年収の上限を考慮し、検索時に許容すべき希望年収の範囲を出力してください。
             - 「○○万円以下」の形式で出力してください
             - 予算内に収まる現実的な候補者をフィルタリングする目的です

            # スカウト文面の作成条件
            作成する目的は「候補者から返信をもらうこと」です。
            ## スカウト件名
            候補者の目を惹きつけ、まずはスカウトを開封させる文章にする
             - 冒頭に企業名、職種名を例を参考に入れる
             - 候補者の好奇心を掻き立てるワードを入れる（以下は例であり、全てを入れる必要はない）
               - ポジションの希少性：社長直下、CTO直下、年収1000万以上
               - 事業の魅力や成長性：売上50億達成、10億資金調達、
            ## スカウト本文
            ### 構成
            1. 挨拶
            2. スカウトの理由
             - 「{{NAME}}様のプロフィールを拝見し、弊社の{{職種名}}としてご活躍いただけないかと思い、お声がけさせていただきました。」の形で出力する
             - 別途、候補者ごとに魅力に感じた点についてコメントを入れるため、上記文章以上の文言は不要です
            3. ポジションの魅力・ベネフィット（提供できる価値）
             - 事業の魅力も踏まえつつ募集ポジションならではのやりがい・魅力を伝える
             - 募集ポジションで働くとどんなキャリアが得られるかを想像させる
             - どんな課題が解けるのか、どんなチャレンジができるのか知的好奇心を刺激する
              - ただし大袈裟な表現はしない（例：「華々しい」「世界へ羽ばたく」「未来を変えませんか？」のような表現はNG）
             - 160~200字で作成する
            4. カジュアルなCTA
             - いきなりの面接案内ではなく、カジュアル面談に誘導する
             - 候補者がアクションを取るのに心理的ハードルを感じない言い回しにする
             - 面談の中で何について伝えたいか（話したいこと）が分かるようにする
            ### 注意事項
            ・候補者名は{{NAME}}で出力してください（ビズリーチの仕様上、勝手にIDに置き換えられます）
            ・会社名を入れる場合は求人票から引っ張ってきてください
            ・送信者側の名前は{{sender}}で出力してください
            ・候補者が視覚的に読みやすい文面になるよう、構成の項目ごと、適切に空白行を入れてください。
            ### 作成例
            ・件名：
            【株式会社xx／フルスタックエンジニア】売上50億円を突破したフードテック企業で、「家庭の義務」をなくす社会変革を技術からリードしませんか？（リモート／フレックス可）
            
            ・本文：
            {{NAME}}様
            
            はじめまして。
            株式会社xxの{{sender}}と申します。
            
            {{NAME}}様のプロフィールを拝見し、弊社のエンジニアとしてご活躍いただけないかと思い、お声がけさせていただきました。
            
            弊社は、Webとリアルを組み合わせたD2C事業を展開しており、
            ユーザー体験から物流・製造までを内包するバリューチェーンの長さが特徴で、
            その複雑さにテクノロジーで挑むやりがいの大きなポジションです。
            また今年は海外法人を設立し、グローバル展開に向けたシステム設計・開発も0→1で行っており、
            非常にチャレンジングな環境となっています。
            
            ぜひ一度、弊社のビジョンや、具体的な開発体制についてお伝えしたく、
            カジュアル面談という形で30分ほどお時間をいただけないでしょうか？
            
            求人概要もご確認いただき、もしご興味を持っていただけましたら、
            ぜひお話させていただけると嬉しいです。
            ご返信を、心よりお待ちしております。
            
            株式会社xx
            {{sender}}
            
            -----
            以上の条件を踏まえ、ビズリーチでの検索設定軸およびスカウト文面を出力してください。
            結果は以下の順番で出力してください。
            1. 募集ポジションにマッチする候補者のペルソナ（これまでの経験や年収レンジの観点から、どんな人物がマッチするかを推測し、出力してください）
            2. 経験職種
            3. 経験業種
            4. 検索キーワード
            5. 現年収
            6. 希望年収
            7. スカウト件名
            8. スカウト文面

            【出力形式（必ずこの通りの純粋なJSONで出力）】
            {{
              "result": [
                {{
                  "persona": "募集ポジションにマッチする候補者のペルソナ",
                  "category": "経験職種",
                  "industry": "経験業種",
                  "keyword": "検索キーワード",
                  "income": "現年収",
                  "desired_income": "希望年収",
                  "scout_title": "スカウト件名",
                  "scout_body": "スカウト文面"
                }}
              ]
            }}

            ・すべての候補者をJSON形式での配列にまとめて返してください。
            ・これは最終出力であり、途中思考は出力しないでください。
          """

# プロンプト作成（A/B/C評価から必須・歓迎要件を作成）
PROMPT_CREATE_PROMPT = """
            あなたは優秀なリクルーターです。企業のリクルーターとして、添付した募集求人(ファイル名：{job_title})に対しての候補者にダイレクトスカウトを送信します。
            【PDFの扱いについて】
            ・ファイル名：{job_title}は募集求人として読み取ってください。
            ・ファイル名：{job_title}以外のファイルは候補者情報として読み取ってください。

            あなたには、以下に示す条件をもとに必須要件、歓迎要件の作成をしてもらいます。

            私は企業のリクルーターで、添付した求人に対してのダイレクトスカウトを運用しています。
            スカウトを送信するにあたり、まずは候補者のマッチ度をA,B,C評価し、A,B評価の候補者だけにスカウトを送信します。(C評価の候補者はスカウト対象外)
            評価の基準は以下の通りです。
            ・A評価：必須要件を満たし、かつ歓迎要件を一部以上満たす
            ・B評価：必須要件は満たすが、歓迎要件は一つも満たさない
            ・C評価：必須要件を一部でも満たさない

            この候補者のマッチ度評価するにあたり、まずは必須要件、歓迎要件を作成したいです。
            あなたは、A,B,C評価それぞれの候補者の経歴を見た上で、そのスキルの差分を言語化し、必須要件、歓迎要件を作成をしてください。

            ## 言語化する目的
            ・候補者のマッチ度評価をするにあたり、A,B,C評価の差分を明確にするため
            ・スカウト対象となる候補者の必須要件、歓迎要件をそれぞれ作成するため
            ### 必須要件とは
            ・候補者が求人に応募するにあたり、必ず持っていなければならないスキル・経験のことです
            ・A,B評価の候補者は満たしているが、C評価の候補者は満たしていない条件が必須要件に当たります
            ### 歓迎要件とは
            ・候補者が求人に応募するにあたり、持っていればより歓迎されるスキル・経験のことです
            ・A評価の候補者は満たしているが、B評価の候補者は満たしていない条件が歓迎要件に当たります

            ## 参考情報
            ### 求人
            ・ファイル「{job_title}」
            ### 候補者ファイルの説明
            ・ファイル「{pdfs_A}」:A評価の候補者リスト
            ・ファイル「{pdfs_B}」:B評価の候補者リスト
            ・ファイル「{pdfs_C}」:C評価の候補者リスト
            ### B評価になった候補者に対してのコメント
            ※ 以下のコメントは歓迎要件を作成するにあたって参考にしてください
            {comment_B}
            ### C評価になった候補者に対してのコメント
            ※ 以下のコメントは必須要件を作成するにあたって参考にしてください
            {comment_C}

            ## 必須要件・歓迎要件作成時の条件
            ・条件の大項目ごとに番号(1~)を振る
            ・小項目（より具体的な条件）があれば、大項目に付随する形で記載する
            ・例外があれば、小項目「以下の場合はC評価となる」を作成し、それに付随する形で条件を記載する
            ・「直近在籍の企業に1年以上勤めており、かつ在籍中である」は必ず大項目の条件として入れる
            ### 作成例
            1. 日本語能力がネイティブである
            2. 直近5年以上、toC/toB向け Webアプリケーションの開発実務経験がある
              - 以下の経験の場合はC評価となる
                - 社内システム・インフラ・汎用系が中心
                - 開発対象が **Windowsデスクトップアプリ, 汎用機システム, 組み込みシステム** に限定されている
            3. 以下のいずれかで実務レベルの経験があり、モダンな技術スタックの整合性がとれている
              - TS/React/Vue/Ruby/Django/GCPなど適合性が高い技術が中心
              - 以下の場合はC評価となる
                - メインの開発言語が **C#, VB.NET, ASP.NET, VBA, COBOL, C/C++ (組み込み/制御)** のみである。
            4. 直近、「実装」工程を担当している
              - 以下の場合はC評価となる
                - 担当工程が **「保守・運用（監視・障害対応）」のみ** で、機能追加開発を行っていない。
                - 担当工程が **「マネジメント・進捗管理・要件定義」のみ** で、直近（ここ1〜2年）の実装経験がない。
            5. 要件定義、基本設計など上流工程の経験が1年以上ある
            6. 直近在籍の企業に1年以上勤めており、かつ在籍中である

            -----
            以上を踏まえ、候補者のマッチ度評価を行うために、A,B,C評価それぞれの候補者のスキルの差分を言語化し、必須要件、歓迎要件を作成してください。
            結果は以下の項目を順番で出力してください。
            1. A評価の候補者が持っている共通のスキル
            2. A,B評価の候補者とC評価の候補者のスキルの差分
            3. A評価の候補者とB評価の候補者のスキルの差分
            4. 必須要件（箇条書きで出力）
            5. 歓迎要件（箇条書きで出力）

            【出力形式（必ずこの通りの純粋なJSONで出力）】
            {{
              "result": [
                {{
                  "common_skill_of_A": "A評価の候補者が持っている共通のスキル",
                  "difference_of_ab_and_c"： "A,B評価の候補者とC評価の候補者のスキルの差分",
                  "difference_of_a_and_b"： "A評価の候補者とB評価の候補者のスキルの差分",
                  "required_condition"： "必須要件（箇条書きで出力）",
                  "welcome_condition"： "歓迎要件（箇条書きで出力）",
                }}
              ]
            }}

            ・すべての候補者を this JSON の配列にまとめて返してください。
            ・これは最終出力であり、途中思考は出力しないでください。
            """
